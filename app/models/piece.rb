class Piece < ApplicationRecord
  enum type: %i[king queen rook bishop knight pawn]

  belongs_to :game

  def move(new_row, new_col)
    if validate_move(new_row, new_col)
      move_diagonal(new_row, new_col)
    end
  end

  protected
  def validate_move(new_row, new_col)
    validate_in_bounds
  end

  def move_linear(rows_to_move)
    self.row += rows_to_move
  end

  def move_lateral(cols_to_move)
    self.column += cols_to_move
  end

  def move_diagonal(rows_to_move, cols_to_move)
    move_linear(rows_to_move)
    move_lateral(cols_to_move)
  end

  def validate_movement(max, min, new_pos)
    (new_pos <= max) && (new_pos >= min)
  end

  def validate_in_bounds(new_row, new_col)
    validate_movement(8, 1, new_row) && validate_movement(8, 1, new_col)
  end
end


class King < Piece
  def validate_move(new_row, new_col)
    super &&
    validate_movement(1, -1, new_row-self.row) &&
    validate_movement(1, -1, new_col-self.col)
  end
end

class Queen < Piece

end

class Rook < Piece

end

class Bishop < Piece

end

class Knight < Piece

end

class Pawn < Piece

end
